/*!
 * Bilbingo 2017-02-12
 * 
 * @author Torbjørn Høvde
 * @version 0.1.0
 * Copyright 2017.
 */
function onDeviceReady(){$.ionSound({sounds:["button_click","door_bump"],path:"sounds/",multiPlay:!0,volume:"1"}),Board.setBoard(5,4),Board.resizeBoard(),localStorage.getItem("isPhoneGap")?$("div.box").bind("touchstart",Board.tapHandler):$("div.box").bind("tap",Board.tapHandler)}var Board=function(){var a=5,b=4,c=0,d=["elgskilt","hest","lastebil","sykkel","barnevogn","kirke"],e=(d.length,new Array),f=0,g=function(a){$.ionSound({sounds:[a],path:"sounds/",multiPlay:!0,volume:"0.4"}),$.ionSound.play(a)},h=function(a){min=Math.floor(a/b)*b,max=min+b,check=!0;for(var c=min;c<max;c++)e[c]>0&&(check=!1);return check},i=function(a,b){return Number(a.split(b)[1])},j=function(f,g){a=g,b=f;for(var h=0;h<a;h++){g=document.createElement("div"),$(g).addClass("row").appendTo($("#board")).attr("id","line"+h).html('<div class="line"></div>');for(var i=0;i<b;i++){f=document.createElement("div");for(var j=!0,k=1+Math.floor(Math.random()*d.length),l=0;l<e.length;l++){e[l]==k&&(j=!1);break}i>0?binder='<img class="binder" src="assets/binder.svg">':binder="",$(f).addClass("box").attr("id","symbol"+c).appendTo($(g)).html(binder+'<img class="star" src="assets/star.svg"><img class="tile" src="assets/tile.png"><img class="check" src="assets/tile_check.png"><img class="symbol" src="symbol/'+d[k-1]+'.png">'),c++,e.push(k)}}},k=function(){$("#board").empty(),j(b,a),p(),localStorage.getItem("isPhoneGap")?$("div.box").bind("touchstart",Board.tapHandler):$("div.box").bind("tap",Board.tapHandler)},l=function(a){check=a.children(".check"),check.css("display","block"),check.addClass("popin")},m=function(a){var b=.1*a.parent().width();star=a.children(".star"),star.css("display","block"),star.css("width",b+"px").css("height",b+"px")},n=function(a){var b=.7,c=a.width()*b;symbol=a.children(".symbol"),symbol.css("width",c+"px").css("height",c+"px")},o=function(a){if($(a.target).hasClass("symbol")){var b=$(a.target).parent();if(b.unbind(),l(b),m(b),n(b),id_str=b.attr("id"),id=i(id_str,"symbol"),e[id]=0,g("button_click"),h(id)){f++;var c=b.parent().find(".binder");c.css("display","block"),g("bell_ring"),navigator.vibrate(1e3)}}},p=function(){var a=$("div#game div#board-wrapper"),b=4/3,c=7/667,d=1*window.innerWidth,e=window.innerHeight,f=d/e;f>b?(d=e*b,a.height(e),a.width(d)):(e=d/b,a.height(e),a.width(d)),a.css("marginTop",-e/2+"px"),a.css("marginLeft",-d/2+"px");var g=$("#board .box, .box img").not(".star"),h=$(".box img.binder"),i=c*(.78*d),j=.78*(d/5-2*i),k=j*(30/95);g.width(j),g.height(j),h.width(k),h.height(k),$("#board .box").css("margin",i+"px"),window.addEventListener("resize",Board.resizeBoard,!1),window.addEventListener("orientationchange",Board.resizeBoard,!1)};return{setBoard:j,resizeBoard:p,resetBoard:k,tapHandler:o}}();localStorage.getItem("isPhoneGap")?document.addEventListener("deviceready",onDeviceReady,!1):$(document).ready(function(){onDeviceReady()});